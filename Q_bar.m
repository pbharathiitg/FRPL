function qbar = Q_bar(e1,e2,mu12,g12,theta)

    mu21 = mu12*(e2/e1);
    q11 = e1/(1-(mu12*mu21));
    q22 = e2/(1-(mu12*mu21));
    q12 = (e1*mu21)/(1-(mu12*mu21));
    q66 = g12;
    a = cosd(theta);
    b = sind(theta);
    Q11 = (q11*(a^4))+(q22*(b^4))+((2*(q12+(2*q66)))*(a^2)*(b^2));
    Q22 = (q11*(b^4))+(q22*(a^4))+((2*(q12+(2*q66)))*(a^2)*(b^2));
    Q12 = ((q11+q22-(4*q66))*(a^2)*(b^2))+(q12*((b^4)+(a^4)));
    Q16 = ((q11-q12-(2*q66))*b*(a^3))+((q12-q22+(2*q66))*a*(b^3));
    Q26 = ((q11-q12-(2*q66))*a*(b^3))+((q12-q22+(2*q66))*b*(a^3));
    Q66 = ((q11+q22-(2*q12)-(2*q66))*(a^2)*(b^2))+(q66*((b^4)+(a^4)));
    qbar = [Q11,Q12,Q16;Q12,Q22,Q26;Q16,Q26,Q66]*(10^9);
    qbar(isnan(qbar))=0;
   

end